{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/auth.service\";\nimport * as i2 from \"../services/utils.service\";\nimport * as i3 from \"@angular/router\";\nfunction ProfileEditComponent_p_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\" \", ctx_r0.user.loading ? \"Loading...\" : \"\", \" \", ctx_r0.user.error, \" \");\n  }\n}\nfunction ProfileEditComponent_div_8_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 33);\n    i0.ɵɵelement(1, \"img\", 34);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"src\", ctx_r0.user.data.img, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction ProfileEditComponent_div_8_small_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 22);\n    i0.ɵɵtext(1, \" Fill this fiels \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProfileEditComponent_div_8_small_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 22);\n    i0.ɵɵtext(1, \" Fill this fiels \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProfileEditComponent_div_8_small_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 22);\n    i0.ɵɵtext(1, \" Fill this fiels \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProfileEditComponent_div_8_small_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 22);\n    i0.ɵɵtext(1, \" Fill this fiels \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProfileEditComponent_div_8_small_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 22);\n    i0.ɵɵtext(1, \" Fill this fiels \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProfileEditComponent_div_8_small_45_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 22);\n    i0.ɵɵtext(1, \" Fill this fiels \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProfileEditComponent_div_8_small_46_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 22);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\" \", ctx_r0.user.error, \" \", ctx_r0.editUser.error, \" \");\n  }\n}\nfunction ProfileEditComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 15)(1, \"div\", 16)(2, \"form\", 17, 0);\n    i0.ɵɵlistener(\"ngSubmit\", function ProfileEditComponent_div_8_Template_form_ngSubmit_2_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.editProfile());\n    });\n    i0.ɵɵtemplate(4, ProfileEditComponent_div_8_div_4_Template, 2, 1, \"div\", 18);\n    i0.ɵɵelementStart(5, \"div\", 19)(6, \"label\", 20);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"input\", 21);\n    i0.ɵɵlistener(\"change\", function ProfileEditComponent_div_8_Template_input_change_8_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.fileChangeEvent($event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(9, \"small\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 23)(11, \"label\", 24);\n    i0.ɵɵtext(12, \"First name*\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"input\", 25, 1);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfileEditComponent_div_8_Template_input_ngModelChange_13_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r0.user.data.first_name, $event) || (ctx_r0.user.data.first_name = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(15, ProfileEditComponent_div_8_small_15_Template, 2, 0, \"small\", 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"div\", 23)(17, \"label\", 24);\n    i0.ɵɵtext(18, \"Last name*\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"input\", 27, 2);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfileEditComponent_div_8_Template_input_ngModelChange_19_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r0.user.data.last_name, $event) || (ctx_r0.user.data.last_name = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(21, ProfileEditComponent_div_8_small_21_Template, 2, 0, \"small\", 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"div\", 23)(23, \"label\", 24);\n    i0.ɵɵtext(24, \"Email*\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"input\", 28, 3);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfileEditComponent_div_8_Template_input_ngModelChange_25_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r0.user.data.email, $event) || (ctx_r0.user.data.email = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(27, ProfileEditComponent_div_8_small_27_Template, 2, 0, \"small\", 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(28, \"div\", 23)(29, \"label\", 24);\n    i0.ɵɵtext(30, \"Job title\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(31, \"input\", 29, 4);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfileEditComponent_div_8_Template_input_ngModelChange_31_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r0.user.data.job, $event) || (ctx_r0.user.data.job = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(33, ProfileEditComponent_div_8_small_33_Template, 2, 0, \"small\", 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(34, \"div\", 19)(35, \"label\", 24);\n    i0.ɵɵtext(36, \"Address\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(37, \"input\", 30, 5);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfileEditComponent_div_8_Template_input_ngModelChange_37_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r0.user.data.address, $event) || (ctx_r0.user.data.address = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(39, ProfileEditComponent_div_8_small_39_Template, 2, 0, \"small\", 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(40, \"div\", 19)(41, \"label\", 24);\n    i0.ɵɵtext(42, \"About myself\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(43, \"textarea\", 31, 6);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfileEditComponent_div_8_Template_textarea_ngModelChange_43_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r0.user.data.about, $event) || (ctx_r0.user.data.about = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(45, ProfileEditComponent_div_8_small_45_Template, 2, 0, \"small\", 26)(46, ProfileEditComponent_div_8_small_46_Template, 2, 2, \"small\", 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(47, \"button\", 32);\n    i0.ɵɵtext(48);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const editForm_r3 = i0.ɵɵreference(3);\n    const first_name_r4 = i0.ɵɵreference(14);\n    const last_name_r5 = i0.ɵɵreference(20);\n    const email_r6 = i0.ɵɵreference(26);\n    const job_r7 = i0.ɵɵreference(32);\n    const address_r8 = i0.ɵɵreference(38);\n    const about_r9 = i0.ɵɵreference(44);\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.user.data.img);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.user.data.img ? \"Change profile picture (Maxsize 1MB)\" : \"Upload profile picture (Maxsize 1MB)\", \" \");\n    i0.ɵɵadvance(6);\n    i0.ɵɵclassProp(\"is-invalid\", first_name_r4.touched && first_name_r4.invalid);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r0.user.data.first_name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", first_name_r4.touched && first_name_r4.invalid);\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"is-invalid\", last_name_r5.touched && last_name_r5.invalid);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r0.user.data.last_name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", last_name_r5.touched && last_name_r5.invalid);\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"is-invalid\", email_r6.touched && email_r6.invalid);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r0.user.data.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", email_r6.touched && email_r6.invalid);\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"is-invalid\", job_r7.touched && job_r7.invalid);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r0.user.data.job);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", job_r7.touched && job_r7.invalid);\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"is-invalid\", address_r8.touched && address_r8.invalid);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r0.user.data.address);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", address_r8.touched && address_r8.invalid);\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"is-invalid\", about_r9.touched && about_r9.invalid);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r0.user.data.about);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", about_r9.touched && about_r9.invalid);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.user.error || ctx_r0.editUser.error);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"disabled\", editForm_r3.invalid || ctx_r0.user.loading || ctx_r0.editUser.loading);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.editUser.loading ? \"Updating profile...\" : \"Update profile\", \" \");\n  }\n}\nexport let ProfileEditComponent = /*#__PURE__*/(() => {\n  class ProfileEditComponent {\n    constructor(_authService, _utils, router) {\n      this._authService = _authService;\n      this._utils = _utils;\n      this.router = router;\n      this.user = {\n        sub: null,\n        error: null,\n        loading: false,\n        data: {\n          img: null,\n          first_name: null,\n          last_name: null,\n          email: null,\n          address: null,\n          about: null,\n          job: null\n        }\n      };\n      this.imgErr = null;\n      this.editUser = {\n        sub: null,\n        loading: false,\n        error: null\n      };\n    }\n    ngOnInit() {\n      this.user.loading = true;\n      this.user.error = null;\n      this.user.sub = this._authService.fetchUserData().subscribe(res => {\n        res = this._utils.makeObjectSelected(res, ['img', 'first_name', 'last_name', 'email', 'address', 'about', 'job']);\n        this.user.data = res;\n        this.user.loading = false;\n        this.user.sub.unsubscribe();\n      }, err => {\n        this.user.error = err;\n        this.user.loading = false;\n        this.user.sub.unsubscribe();\n      });\n    }\n    editProfile() {\n      this.editUser.loading = true;\n      this.editUser.error = null;\n      this.user.data = this._utils.trimObject(this.user.data);\n      const formData = new FormData();\n      formData.append('email', this.user.data.email);\n      formData.append('first_name', this.user.data.first_name);\n      formData.append('last_name', this.user.data.last_name);\n      formData.append('job', this.user.data.job);\n      formData.append('address', this.user.data.address);\n      formData.append('about', this.user.data.about);\n      if (this.image) {\n        formData.append('img', this.image);\n      }\n      this.editUser.sub = this._authService.editUser(formData).subscribe(res => {\n        this._authService.$User.next({\n          _id: res._id,\n          first_name: res.first_name,\n          role: res.role\n        });\n        this.editUser.loading = false;\n        this.router.navigate(['/profile', res._id]);\n      }, err => {\n        this.editUser.error = err;\n        this.editUser.loading = false;\n      });\n    }\n    fileChangeEvent(e) {\n      if (e.target.files.length > 0) {\n        this.image = e.target.files[0];\n        const file = e.target.files[0];\n        const reader = new FileReader();\n        reader.onload = () => {\n          this.user.data.img = reader.result;\n        };\n        reader.readAsDataURL(file);\n      }\n    }\n    static #_ = (() => this.ɵfac = function ProfileEditComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || ProfileEditComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.UtilsService), i0.ɵɵdirectiveInject(i3.Router));\n    })();\n    static #_2 = (() => this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ProfileEditComponent,\n      selectors: [[\"app-profile-edit\"]],\n      decls: 9,\n      vars: 2,\n      consts: [[\"editForm\", \"ngForm\"], [\"first_name\", \"ngModel\"], [\"last_name\", \"ngModel\"], [\"email\", \"ngModel\"], [\"job\", \"ngModel\"], [\"address\", \"ngModel\"], [\"about\", \"ngModel\"], [1, \"card\", \"bgLight\"], [1, \"container\", \"py-3\"], [1, \"card-body\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-pencil-square-o\", \"me-1\"], [1, \"container\"], [\"class\", \"mt-2 mb-5 pb-5\", 4, \"ngIf\"], [\"class\", \"row py-5\", 4, \"ngIf\"], [1, \"mt-2\", \"mb-5\", \"pb-5\"], [1, \"row\", \"py-5\"], [1, \"col-md-6\", \"col-12\"], [\"enctype\", \"multipart/form-data\", 1, \"row\", \"g-3\", 3, \"ngSubmit\"], [\"class\", \"imgCap\", 4, \"ngIf\"], [1, \"mb-3\"], [\"for\", \"formFileSm\", 1, \"form-label\"], [\"type\", \"file\", \"accept\", \"image/*\", 1, \"form-control\", \"form-control-sm\", 3, \"change\"], [1, \"text-danger\"], [1, \"col-md-6\", \"col-12\", \"mb-3\"], [1, \"form-label\"], [\"type\", \"text\", \"required\", \"\", \"name\", \"first_name\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [\"class\", \"text-danger\", 4, \"ngIf\"], [\"type\", \"text\", \"required\", \"\", \"name\", \"last_name\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"email\", \"required\", \"\", \"name\", \"email\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"text\", \"name\", \"job\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"text\", \"name\", \"address\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"text\", \"name\", \"about\", 1, \"form-control\", 2, \"height\", \"100px\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"submit\", 1, \"btn\", \"btn-dark\", \"me-2\", 3, \"disabled\"], [1, \"imgCap\"], [\"alt\", \"\", 1, \"imagepreview\", 3, \"src\"]],\n      template: function ProfileEditComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 7)(1, \"div\", 8)(2, \"div\", 9)(3, \"h4\");\n          i0.ɵɵelement(4, \"i\", 10);\n          i0.ɵɵtext(5, \" Edit ptofile \");\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(6, \"div\", 11);\n          i0.ɵɵtemplate(7, ProfileEditComponent_p_7_Template, 2, 2, \"p\", 12)(8, ProfileEditComponent_div_8_Template, 49, 29, \"div\", 13);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(7);\n          i0.ɵɵproperty(\"ngIf\", ctx.user.loading || ctx.user.error);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.user.loading && !ctx.user.error);\n        }\n      },\n      styles: [\".imgCap[_ngcontent-%COMP%]{width:180px;height:180px}.imgCap[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:5px;height:100%;width:100%;object-fit:cover}\"]\n    }))();\n  }\n  return ProfileEditComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}